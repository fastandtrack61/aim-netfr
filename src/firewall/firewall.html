<div class="p-6">

  <h2 class="text-2xl text-cyan-300 mb-4">Firewall Rules</h2>

  <button (click)="generateAI()" class="px-4 py-2 bg-purple-600 rounded mb-6">
    Generate AI Rules
  </button>

  <h3 class="text-lg text-gray-300 mb-2">Add Rule</h3>

  <div class="grid grid-cols-2 gap-4 bg-gray-800 p-4 rounded mb-6">

    <div>
      <label>Source IP</label>
      <input class="input" [(ngModel)]="newRule.srcIp" placeholder="ANY">
    </div>

    <div>
      <label>Destination IP</label>
      <input class="input" [(ngModel)]="newRule.dstIp">
    </div>

    <div>
      <label>Protocol</label>
      <select class="input" [(ngModel)]="newRule.protocol">
        <option>ANY</option>
        <option>TCP</option>
        <option>UDP</option>
        <option>ICMP</option>
      </select>
    </div>

    <div>
      <label>Direction</label>
      <select class="input" [(ngModel)]="newRule.direction">
        <option>BOTH</option>
        <option>INBOUND</option>
        <option>OUTBOUND</option>
      </select>
    </div>

    <div>
      <label>Source Port</label>
      <input class="input" [(ngModel)]="newRule.srcPort" placeholder="ANY">
    </div>

    <div>
      <label>Destination Port</label>
      <input class="input" [(ngModel)]="newRule.dstPort">
    </div>

    <div>
      <label>Action</label>
      <select class="input" [(ngModel)]="newRule.action">
        <option>ALLOW</option>
        <option>DENY</option>
        <option>REJECT</option>
      </select>
    </div>

    <div>
      <label>Log</label>
      <input type="checkbox" [(ngModel)]="newRule.log">
    </div>

  </div>

  <button (click)="addRule()" class="px-4 py-2 bg-green-600 rounded">
    Add Rule
  </button>

  <hr class="my-6 border-gray-700">

  <h3 class="text-lg text-gray-300 mb-2">Current Rules</h3>

  <table class="min-w-full bg-gray-900 text-gray-200 rounded shadow">
    <thead class="bg-gray-800">
      <tr>
        <th class="p-2">Src → Dst</th>
        <th class="p-2">Protocol</th>
        <th class="p-2">Ports</th>
        <th class="p-2">Dir</th>
        <th class="p-2">Action</th>
        <th class="p-2">AI</th>
        <th class="p-2 text-right">Delete</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let r of rules" class="border-t border-gray-800">
        <td class="p-2">{{ r.srcIp }} → {{ r.dstIp }}</td>
        <td class="p-2">{{ r.protocol }}</td>
        <td class="p-2">{{ r.srcPort }} → {{ r.dstPort }}</td>
        <td class="p-2">{{ r.direction }}</td>
        <td class="p-2">{{ r.action }}</td>
        <td class="p-2">{{ r.aiGenerated ? 'Yes' : 'No' }}</td>
        <td class="p-2 text-right">
          <button (click)="deleteRule(r.id)" class="px-3 py-1 bg-red-600 rounded">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>

</div>
